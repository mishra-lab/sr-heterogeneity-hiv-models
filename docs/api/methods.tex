We conducted a scoping review according to the PRISMA extension for scoping reviews
(see Appendix~\ref{a:prisma} for checklist).
% JK: might want a different word than "appraise" as appraise implies
%     judging value, which, not sure if that's what we want to do here ...  %SM: yeah, I see your point here. how about these pot'l edits? (e.g. "synthesize", or "review")?
First, we developed a framework to synthesize  %SM: or review or categorize?
the assumptions and representations of risk heterogeneity
in compartmental HIV transmission models.
Then, we designed and implemented the search strategy,
and extracted the data relevant to the framework
to address the objectives.
% ==============================================================================
\subsection{Appraisal Framework}  %SM: what do you think about using term "conceptual framework for risk heterogeneity" instead of "appraisal framework"? 
\label{ss:meth:framework}
For the review, we conceptualized ``factors of risk heterogeneity'', meaning
epidemiological stratifications and phenomena which may/not be included in transmission models.
Such factors could include if/how populations, rates, and probabilities
are stratified along health and social dimensions.
We defined the following 4 domains through which
% JK: need better wording for "domains through which"
these factors of risk heterogeneity might influence ART prevention impact.
\begin{itemize}
  \item \textbf{Biological Effects:}
  differential transmission risk within HIV disease course
  that coincide with differential ART coverage
  \cite{Pilcher2004}
  \item \textbf{Behaviour Change Effects:}
  differential transmission risk due to
  behavioural changes related to engagement in the ART cascade
  \cite{Ramachandran2016,Tiwari2020} % JK: TODO
  \item \textbf{Network Effects:}
  differential transmission risk within sub-populations
  that increase the challenge of epidemic control through core group dynamics
  \cite{Anderson1986,Boily1997,Watts2010,Dodd2010}
  \item \textbf{Coverage Effects:}
  differential transmission risk within sub-populations
  who also experience barriers to engaging in ART care and achieving viral suppression,
  such as youth and key populations
  \cite{Mountain2014,Lancaster2016,Hakim2018,Green2020}
\end{itemize}
We compiled a list of key factors of risk heterogeneity,
and their associated mechanisms of influence on ART prevention impact (Table~\ref{tab:factors}).
We did not attempt to define the magnitude or direction of each factor's influence,
since these can depend on the context, time horizon,
and which if any parameters were fitted during model calibration.\cite{Eaton2014}
\afterpage{%
  \newgeometry{margin=2cm}
  \begin{landscape}
    \captionof{table}{%
      Factors of heterogeneity in HIV transmission
      and their possible mechanisms of influence on the prevention impact of ART interventions}
    \input{tab/factors}
    \label{tab:factors}
  \end{landscape}
  \restoregeometry
\clearpage}
% ==============================================================================
\subsection{Search}
\label{ss:meth:search}
We searched MEDLINE and EMBASE via Ovid
using search terms related to Sub-Saharan Africa (SSA), HIV, and transmission modelling
(Appendix~\ref{aa:search:terms}).
Duplicate studies were removed automatically and also manually.
Potentially relevant studies were identified by title and abstract screening.
Further selection of studies and subsequent data extraction used
the full text and any available supplementary material.
One reviewer (JK) conducted the search and data extraction.
% ------------------------------------------------------------------------------
\subsubsection{Inclusion/Exclusion Criteria}
\label{sss:meth:criteria}
We sought to identify studies applying dynamical models of sexual HIV transmission
to project the prevention impacts of increases in ART coverage in SSA.
Complete inclusion/exclusion criteria are given in
Appendix~\ref{aa:search:criteria}.
Peer-reviewed English journal articles published up to Dec 31, 2019
were considered for inclusion.
We excluded publications without primary modelling results,
such as commentaries and reviews, as well as conference publications.
\par
Articles were considered for inclusion if they used a dynamical compartmental model of
sexual HIV transmission at the population level.
We define a \emph{dynamical model} as one where
the number of infections projected at time $t$ is a function of
the number of infections previously projected by the model before time $t$.
We define a \emph{compartmental model} as one where
the system variables represent the numbers of individuals in each state,
rather than unique individuals.
Statistical models, non-dynamical models, and individual-based models were excluded.
Articles were further considered for inclusion if model parameters
were chosen to reflect at least one context within SSA
(see Table~\ref{tab:search-ssa} for full country list).
Finally, articles were included if they
simulated at least one scenario with increasing ART coverage,
possibly alongside scale-up of other interventions.
The included articles formed Dataset~A,
used to answer research questions \ref{rq:1}~and~\ref{rq:2}.
\par
A subset of Dataset~A formed Dataset~B,
which used to answer research question~\ref{rq:3}.
Articles in Dataset~B specifically examined
scale-up of ART coverage alone (vs combination intervention)
for the whole population (vs ART targeted to subgroups),
and reported HIV incidence reduction or cumulative HIV infections averted
after a number of years, as compared to a base-case scenario reflecting the status quo.
% ==============================================================================
\subsection{Data Extraction}
\label{ss:meth:data}
% JK: I use the word "noted" about a bajillion times here
%     since it is short and unpretentious,
%     and I personally find the meaning clear in this context. @SM hoping you agree?
For research questions \ref{rq:1}~and~\ref{rq:2}, data were extracted per-article.
For research question~\ref{rq:3}, data were extracted per-scenario within the article.
%We also noted whether multiple articles used the same model. % currently unused.
Additional variables definitions are given in Appendix~\ref{a:defs}.
% ------------------------------------------------------------------------------
\subsubsection{Epidemic Context}
\label{sss:meth:context}
To answer our first research question, we extracted the following data.
Articles were categorized by the geographic location (country and SSA region)
and scale of the simulated population (city, sub-national, national, regional),
including whether multiple geographic contexts were considered.
The epidemic phase was categorized based on
the overall HIV prevalence (low: $<1\%$, medium: $1-10\%$, high: $>10\%$),
and the trend in incidence at the time that scenarios diverged
(increasing, increasing but stabilizing, stable/equilibrium,
decreasing but stabilizing, and decreasing).
Finally, we noted whether the simulated population
included any of the following key populations:
female sex workers (FSW);
male clients of FSW (Clients);
men who have sex with men (MSM); and
people who inject drugs (PWID).
%adolescent girls and young women (AGYW); and
%mobile populations;
See key population definitions in Appendix~\ref{aaa:defs:kp}
% ------------------------------------------------------------------------------
\subsubsection{Factors of Risk Heterogeneity}
\label{sss:meth:factors}
For our second research question, we examined if and how
the factors of risk heterogeneity outlined in Table~\ref{tab:factors}
were simulated in each study.
\par
Special focus was given to the factors related to Network and Coverage Effects,
due to the large variability in how these factors were simulated.
% JK: @SM: two questions
%     1. If so, ^ is this sufficient justification?
%     2. Since most other factors in Table 1 are extracted like "included: yes/no",
%        I didn't want to waste space here to re-define them all.
%        Plus, they are repeated again in the results as well. Is that ok?
We examined the number and defining characteristics of
\emph{activity groups}, including
sex, different rates of partnership formation, and different types of partnerships.
We noted whether each of the \emph{key populations} noted above
was included in the model.
Any \emph{turnover} of individuals between
activity groups and/or key populations was noted.
Similarly, we noted whether ART coverage was assumed to be
equal across modelled risk groups,
possibly ignoring historical gaps/future challenges in reaching higher risk groups.
\par
We noted whether multiple \emph{partnership types} were simulated,
and how such partnerships were defined:
generic (all partnerships equal);
based on the activity groups involved;
or reflecting phenomenological types
(main/spousal; casual; commercial/sex work; and transactional).
We noted whether partnerships considered different
volumes of sex (total number of coital acts per partnership)
and levels of condom use.
We noted whether models simulated any degree of assortative vs proportionate
\emph{mixing} between activity groups.
The number of unique \emph{age groups} was noted, as well as
whether \emph{mixing} by age groups was
proportionate, strictly assortative, or assortative with age differences.
Finally, we noted whether age conferred any additional risk beyond mixing,
such as higher rates of partnership formation.
\par
Finally, we noted whether differences in rates of progression along the \emph{ART cascade}
were considered between age groups, sexes, activity groups, and/or key populations.
Specifically, we noted differences in rates of
diagnosis, ART initiation, and treatment discontinuation (due to either dropout or resistance).
% ------------------------------------------------------------------------------
\subsubsection{ART Prevention Impact}
\label{sss:meth:api}
For our third research question, we examined the subset of studies (Dataset~B)
reporting incidence reduction or infections averted due to
population-wide ART scale-up.
We extracted the following data for each scenario of ART scale-up within Dataset~B:
the years that ART scale-up started and stopped, corresponding to
the time each scenario diverged from the base-case scenario ($t_0$) and
the time ART coverage or initiation rates stabilized following scale-up ($t_f$);
the final overall ART coverage achieved and/or
the final ART initiation rate (per person-year among PLHIV not yet in care);
the criteria for ART initiation (e.g. CD4 count);
and the relative reduction in transmission probability on ART.
Then, we extracted relative reduction in incidence or proportion of infections averted
reported for different time horizons relative to $t_0$.
Figure data were extracted for any of the following time horizons, if available:
5, 10, 15, 20, 30, and 40 years,
with the help of a graphical measurement tool.%
\footnote{WebPlotDigitizer: \hreftt{https://apps.automeris.io/wpd/}}
\par
Finally, for each factor of heterogeneity,
we compared the projected ART prevention impacts across
the different factor levels (whether or not, and how the factor was modelled).
We plotted impact magnitude vs time since $t_0$, stratified by factor levels,
and tested whether the distribution of impact magnitudes
was the same under all factor levels (non-parametric Kruskal-Wallis test).